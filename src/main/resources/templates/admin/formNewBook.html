<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Nuovo Libro</title>
  <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
</head>
<body>
  <div>
    <a th:href="@{/}"><img th:src="@{/images/logo.png}" width="20%" alt="Logo"></a>
  </div>
  <div class="container mt-4">
    <h2>Aggiungi un libro</h2>
    <form th:action="@{/admin/book}" th:object="${book}" method="POST" enctype="multipart/form-data">
      
      <!-- error globali -->
      <p th:each="err : ${#fields.globalErrors()}" th:text="${err}" class="text-danger"></p>
      
      <div class="mb-3">
        <label class="form-label">Titolo:</label>
        <input required type="text" th:field="*{titolo}" class="form-control">
        <div th:if="${#fields.hasErrors('titolo')}" th:errors="*{titolo}" class="text-danger"></div>
      </div>
      
      <div class="mb-3">
        <label class="form-label">Anno pubblicazione:</label>
        <input required type="text" th:field="*{annoPubblicazione}" class="form-control">
        <div th:if="${#fields.hasErrors('annoPubblicazione')}" th:errors="*{annoPubblicazione}" class="text-danger"></div>
      </div>
      
      <div class="mb-3">
        <label class="form-label">Immagini del libro:</label>
        <input type="file" name="bookImages" accept="image/*" multiple class="form-control">
      </div>
      
      <div class="mb-3">
        <label class="form-label">Autori:</label>
        <!-- campo di filtro -->
        <input type="text"
               class="form-control mb-2 list-filter"
               placeholder="Cerca un autore..."
               data-target="authors"/>
        <!-- select multipla -->
        <select multiple
                id="authors"
                class="form-select"
                size="6"
                th:field="*{authors}">
          <option th:each="aut : ${allAuthors}"
                  th:value="${aut.id}"
                  th:text="${aut.name + ' ' + aut.surname}">
          </option>
        </select>
        <div class="form-text">Tieni premuto Ctrl (o Cmd) per selezionare pi√π autori.</div>
      </div>
      
      <button type="submit" class="btn btn-primary">Conferma</button>
      <a th:href="@{/books}" class="btn btn-secondary">Annulla</a>
    </form>
  </div>
  
  <!-- script per il filtro live sul select -->
  <script th:src="@{/js/filterList.js}"></script>
</body>
</html>
