</html>
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Autore - Admin</title>
    <meta charset="UTF-8" />
    <title th:text="${author != null ? author.name + ' ' + author.surname : 'Autori'}">Autori</title>
    <link rel="stylesheet" href="/css/base.css" />
    <link rel="stylesheet" href="/css/singleAuthor.css" />
</head>

<body>
    <!-- Navbar -->
    <div th:replace="fragments/adminNavbar :: navbarAdmin"></div>

    <main class="content">
        <!-- Sezione Autore -->
        <section class="author" th:if="${author}">
            <h2 th:text="${author.name + ' ' + author.surname}">Nome Cognome</h2>
            <p><strong>Nazionalità:</strong> <span th:text="${author.nationality}">Nazionalità</span></p>
            <p><strong>Data di nascita:</strong>
               <span th:text="${#temporals.format(author.birth, 'dd/MM/yyyy')}">01/01/1900</span>
            </p>
            <p th:if="${author.death != null}">
                <strong>Data di morte:</strong>
                <span th:text="${#temporals.format(author.death, 'dd/MM/yyyy')}">01/01/2000</span>
            </p>

            <!-- Immagine Autore -->
            <div class="author-image" th:if="${author.image}">
                <img th:src="@{/uploads/{file}(file=${author.image.path})}"
                     alt="Foto di [[${author.name}]]" />
            </div>

            <!-- Libri dell'Autore -->
            <section class="books-section" th:if="${author.books}">
                <h3>Opere</h3>
                <div class="books-list">
                    <div class="book-card" th:each="book : ${author.books}">
                        <a th:href="@{'/book/' + ${book.id}}">
                        <!-- Se ci sono immagini -->
                        <img th:if="${book.immagini != null and !book.immagini.isEmpty()}"
                            th:src="@{'/uploads/' + ${book.immagini[0].path}}"
                            alt="Copertina di [[${book.titolo}]]">
                        <!-- Placeholder se non ci sono immagini -->
                        <img th:if="${book.immagini == null or book.immagini.isEmpty()}"
                            src="/images/default_book.jpg"
                            alt="Nessuna immagine disponibile">
                            <div class="book-info">
                                <h4 th:text="${book.titolo}">Titolo libro</h4>
                                <p th:text="${book.annoPubblicazione}">2000</p>
                            </div>
                        </a>
                    </div>
                </div>
            </section>
        </section>

        <div class="author-actions">
        <a th:href="@{/admin/editAuthor/{id}(id=${author.id})}" class="modify-author">
            <i class="bi bi-pencil"></i> Modifica autore
        </a>

        <form th:action="@{/admin/deleteAuthor/{id}(id=${author.id})}"
                method="post"
                onsubmit="return confirm('Sei sicuro di voler eliminare questo autore e la sua immagine?');">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
            <input type="hidden" name="_method" value="delete"/>
            <button type="submit" class="delete-author">
            <i class="bi bi-trash"></i> Elimina autore
            </button>
        </form>
        </div>

        <div class="author" th:unless="${author}">
            <p>Autore non esistente.</p>
        </div>
    </main>
</body>
</html>
